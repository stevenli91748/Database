


 * 需求建模
    * [需求分析](#需求分析)---就是要明确系统的数据存储需求
    * [概念设计](#概念设计)
      * [1. E-R图](#E-R-图)
      * [2. 表结构设计](#表结构设计)
        * 表结构设计工具
          * MySQL workbench
          * Navicat
          * phpMyAdmin
      * [3. 列的约束，限制](#列的约束-限制)
      * [4. 索引的设计](#索引的设计)
      
---

## 需求分析
    
    选定数据库产品后，进入数据库设计阶段，需求建模是数据库设计的第一步，它包括需求分析和概念设计两个步骤。需求分析就是要明确系统的数据存储需求，主要包括以下几个方面。
    
    • 存储内容需求：要明确哪些数据是需要存储的，在前面介绍的电商业务案例中，商品信息、订单信息及会员信息都是我们系统需要存储的数据。
    • 数据限制与约束：要明确存储的数据类型、长度限制及数据的约束，包括是否允许为空值，是否必须全局唯一等。
    • 数据操作：要明确系统对这些数据需要完成哪些操作，例如会员购买某个商品，首先要查看商品的信息，就需要完成一次商品信息的读取操作，操作的输入与输出也必须明确，例如要读取商品的哪些信息，
      根据什么条件来筛选商品信息。
      
    明确需求的最佳途径就是产品需求文档，如果有一份完整的产品需求文档，我们就可以根据产品需求文档中描述的功能需求，来整理我们需要的数据存储需求。但是对于一些创业团队，可能没有产品策划或者产
    品经理，或者是由开发者来承担的，那我们就需要通过还原用户的使用场景，来明确功能需求，然后再理清数据存储的需求。  

## 概念设计

    有了数据存储需求，接下来我们就要完成概念设计，即数据建模。我们经常使用的一个工具即E-R 图（ Entity Relationship Diagram ） 。E-R 图使用实体、属性和联系来描述现实世界的数据。

### E R 图

### 表结构设计

    完成E-R 图后，我们就可以开始将E-R 图转换成关系型数据库中的表结构。一般来说，我们将E-R 图中的实体单独成为关系型数据库中的一张表，将实体的属性定义为每张表的列，如果属性中有能够唯一标识的
    键，就将其定义为表主键，如果存在多个健属性，就选择其中一个作为主键，其他的设置为唯一键约束。如果不存在唯一键，就单独增加一列，设置自增属性，将其作为主键。对于MySQL 数据库，我们强烈建议开
    发者在设计表时，必须指定主键，因为没有主键，不仅会影响数据库的插入性能，还会导致MySQL 复制的性能问题。另外，我们也建议开发者尽量使用与业务无关的自增列作为主键，这样可以提高插入和按插入顺
    序检索的效率。对于实体之间的联系，我们可以在表结构设计时做如下转换。
    
    • 1 : 1 ：在一个实体对应的表中增加另外一个实体的主键作为一列，在电商业务场景中，尤其使用MySQL 数据库时，我们不建议开发者在两个表之间设置外键约束，因为这样在扩展数据库时会受到限制。
    • 1 : N ：在多个实体对应的表中增加一列，将一个实体对应表的主键作为该列的值。这样，我们可以通过该列进行关联查询。
    • N : M ：单独一张表来维护两个实体之间的关系，将两个实体对应的表的主键分别作为该表的两个属性，通过这两个属性之间的连接，完成表之间的关联查询。

#### 列的约束 限制

    定义了表整体结构后，接下来我们就要针对每一个列明确具体的数据类型、长度限制、约束及索引相关内容
    
    

#### 索引的设计

    最后，我们需要完成索引的设计，这也是表结构设计中难度最大，又最为关键的一部分内容，它对后续数据库访问性能有非常大的影响。我们需要了解3 个问题。
    
    • 为什么要创建索引？
      第一个问题，在MySQL 数据库中，存在两类索引，分别是主键索引和二级索引。在默认的Inno DB 存储引擎中，数据记录是按照主键宇段构建的B ＋树的组织存储的，如果开发者在创建表时，没有指定主键，
      InnoDB 也会默认为该表自动生成一个主键，但是我们非常不建议开发者这么使用，因为这会造成一系列性能问题。所以主键是数据存储结构构建的依据，每张表都要有。第二种就是二级索引，它的存在主要是
      基于性能的考虑，如果在某个字段或者某几个字段创建一个二级索引，则基于这些字段的查询会相对更快，代价更低。
    
    • 创建索引会对数据库产生什么影响？
      第二个问题，既然二级索引能够加速数据库的访问，是不是创建得越多越好呢，这与索引在数据库的内部实现相关。实际上数据库创建索引是有开销的，创建一个二级索引，数据库系统就会新构建一棵B＋树，与
      主键索引不同的是，二级索引的叶子节点不是数据库记录，而是主键的值。一旦该表涉及索引字段的更新，记录的插入或者删除，就会导致二级索引B＋树的节点合并和分裂，造成数据库很大的开销。所以索引确
      实可以加速数据库访问，但是也会造成一定的系统开销，必须要合理创建索引，才能发挥最大的功效。
    
    • 如何选择索引字段？
    
      最后一个问题就是如何合理选择索引宇段，以达到高效的访问。索引字段的选择与应用访问数据库的SQL 息息相关。最常用的规则如下。
      
        • 查询、更新、删除语句涉及的条件字段对应的属性列应该创建索引。
        • 如果存在多张表的关联查询，连接字段应该创建索引。
        • 频繁更新的宇段不直创建索引。
        • 如果存在多个索引交叉，可以创建多个字段的联合索引，但是需要注意的是，索
    
      引的宇段顺序必须要与查询条件中的宇段顺序一致。开发者遵循上述基本的原则，可以创建出较为高效的索引。


